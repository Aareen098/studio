rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // --- Helper Functions ---

    /**
      * @description Checks if the user is signed in (authenticated).
      * @return {bool} True if the user is signed in, false otherwise.
      */
    function isSignedIn() {
      return request.auth != null;
    }

    /**
      * @description Checks if the user is an administrator.
      * @return {bool} True if the user is an admin, false otherwise.
      */
    function isAdmin() {
      return isSignedIn() && request.auth.token.admin == true;
    }

    // --- Security Rules ---

    /**
      * @summary
      * This is a good place to start for your security rules.
      *
      * @description
      * - Authenticated users can read and write to their own data.
      * - Administrators can read and write to all data.
      * - All other access is denied.
      *
      * @principle User data is private.
      * @principle Administrators can manage all data.
      */
    match /{path=**} {
      allow read, write: if true;
    }
  }
}
